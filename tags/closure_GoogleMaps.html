<!doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Language" content="zh-CN" />
	<title>google maps</title>
	<script src="http://ditu.google.cn/maps/api/js?sensor=false&language=zh-CN"></script>
	<script>
		var Gmap = function(){};
		Gmap.prototype={
			map:null,
			markerArray:[],
			initialize:function() {
				var latlng = new google.maps.LatLng(39.397, 116.644);
				var myOptions = {
					zoom: 4, center: latlng, 
					disableDefaultUI: true,zoomControl:true,
					zoomControlOptions:{'style':'SMALL'},
					mapTypeId: google.maps.MapTypeId.ROADMAP 
				};
				map = new google.maps.Map(document.getElementById("map"), myOptions);
			},
			
			placeMarker:function(){
				var lat = 39.397;	//纬度 就是y轴
				var lng = 116.644;	//经度 x轴
				var d2r = Math.PI/180;
				var r2d = 180/Math.PI;
				var Clat = (500/3963)*r2d;		//园面积
				var Clng = Clat/Math.cos(lat*d2r);

				for (var i = 0; i < 40; i++) {
					var theta = Math.PI * (i/20);	//半圈几个点
					var Cy = lat + (Clat * Math.sin(theta));
					var Cx = lng + (Clng * Math.cos(theta));
					var latlng = new google.maps.LatLng(Cy,Cx);
					var marker = new google.maps.Marker({
							position: latlng,
							map: map,
							animation: google.maps.Animation.DROP
						});

					Gmap.markerArray.push(marker);		//存入数组
					Gmap.toggleBounce(marker,i);		//跳动方法
					setTimeout(Gmap.clear,10000);		//10秒后删除Marker
				}
			},		
			//清除marker
			clear:function(){
				var mArr = Gmap.markerArray;
				if (mArr){
					for(i in mArr){
						mArr[i].setMap(null);
					}
					mArr.length = 0;
				}
			},
			//跳动方法（点击跳动，再点停）
			toggleBounce:function(marker,i) {
				google.maps.event.addListener(marker, 'mouseover', function(){
					 if(marker.getAnimation() == null){
						marker.setAnimation(google.maps.Animation.BOUNCE);
						setTimeout('Gmap.stop('+i+')',700);//700毫秒后停止
					}else{
						marker.getAnimation(null);
					}
				});
			 },
			//700毫秒后停止
			stop:function(i){
				var mArr = Gmap.markerArray;
				if(mArr.length!=0){
					mArr[i].setAnimation(null);
				}
			}
		};
		var Gmap = new Gmap();
	</script>

</head>
<body  onload="Gmap.initialize()">
	<div id="map" style="width:800px;height:600px;border:1px red solid;"></div>
	<input type="button" value="给我来个光环，悬停可跳动" onClick="Gmap.placeMarker()" />
	<input type="button" value="清除圈" onClick="Gmap.deleteOverlays()" />
</body>
</html>
